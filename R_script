#Note: This example performs QENIE on the liver-to-adipose circuit.  For purposes of replication and ease, other datasets are provided whereby similar analyses could easily be applied

#Import your data
Adipose <- read.csv("path_location/Adipose", header=TRUE)
Liver <- read.csv("path_location/Liver", header=TRUE)

#Using these two datasets we will proceed:

#Construct cross-tissue correlation and pvalue matrices
library(WGCNA)
liv.adip.cor = bicor(Adipose, Liver, use='pairwise.complete.obs')
liv.adip.cor = as.data.frame(liv.adip.cor)
liv.adip.p = corPvalueStudent(liv.adip.p, nSamples = 106)

#Compute rowsum -log(pvalue) for ranking interactions and filter for factors proteins as secreted
ll = as.data.frame(liv.musc.p)
liv.musc.log = -log(ll)


Condition correlation matrix on a by-gene basis for pathway enrichment


